#!/usr/bin/env python

import rospy
import actionlib
from control_msgs.msg import FollowJointTrajectoryAction, FollowJointTrajectoryGoal
from trajectory_msgs.msg import JointTrajectoryPoint

JOINT_NAMES = ['shoulder_pan_joint', 'shoulder_lift_joint', 'elbow_joint', 'wrist_1_joint',
               'wrist_2_joint', 'wrist_3_joint']

def arm_client():
    client = actionlib.SimpleActionClient('move', FollowJointTrajectoryAction)
    print("aaaaaaaaaa")
    client.wait_for_server()
    print("bbbbbbbb")
    # make goal
    goal = FollowJointTrajectoryGoal()
    goal.trajectory.joint_names = JOINT_NAMES
    goal.trajectory.points = toJointTrajectoryPoint([(-1.7667559222150564, -0.33867824650507217, 0.9539507574573997, 0.963937568648913, 1.5730515006204613, -1.7648161984839672), (-1.7574490716633926, -0.3257515326996958, 0.9203428632367443, 0.9827624633451989, 1.5726538177523728, -1.7556797075099542), (-1.7481422211117288, -0.31282481889431946, 0.886734969016089, 1.0015873580414847, 1.5722561348842843, -1.7465432165359411), (-1.738835370560065, -0.2998981050889431, 0.8531270747954336, 1.0204122527377706, 1.5718584520161958, -1.737406725561928), (-1.7295285200084012, -0.2869713912835668, 0.8195191805747782, 1.0392371474340565, 1.5714607691481073, -1.728270234587915), (-1.7202216694567374, -0.2740446774781905, 0.7859112863541229, 1.0580620421303424, 1.5710630862800188, -1.719133743613902), (-1.7109148189050736, -0.26111796367281415, 0.7523033921334676, 1.0768869368266283, 1.5706654034119303, -1.709997252639889), (-1.7016079683534098, -0.24819124986743782, 0.7186954979128123, 1.0957118315229142, 1.5702677205438418, -1.700860761665876), (-1.692301117801746, -0.2352645360620615, 0.6850876036921569, 1.1145367262192, 1.5698700376757533, -1.691724270691863), (-1.6829942672500822, -0.22233782225668516, 0.6514797094715017, 1.133361620915486, 1.5694723548076648, -1.68258777971785), (-1.6736874166984184, -0.20941110845130884, 0.6178718152508464, 1.1521865156117719, 1.5690746719395763, -1.6734512887438369), (-1.6643805661467546, -0.1964843946459325, 0.5842639210301911, 1.1710114103080576, 1.5686769890714878, -1.6643147977698238), (-1.6550737155950905, -0.18355768084055618, 0.5506560268095357, 1.1898363050043432, 1.5682793062033993, -1.6551783067958108), (-1.6457668650434267, -0.17063096703517985, 0.5170481325888805, 1.2086611997006291, 1.5678816233353108, -1.6460418158217978)])
    client.send_goal(goal)

    print("cccccccccc")
    client.wait_for_result()
    print("dddddddddd")
    return client.get_result()


def toJointTrajectoryPoint(waypoints):
    """
    transform a list of waypoints to a list of JointTrajectoryPoint
    """
    list = []
    for point in waypoints:
        list.append(JointTrajectoryPoint(positions=point))

    return list

if __name__ == '__main__':
    try:
        rospy.init_node('arm_demo')
        result = arm_client()
        print(f'result is {result}')
    except rospy.ROSInterruptException:
        print("program is interrupted.")
